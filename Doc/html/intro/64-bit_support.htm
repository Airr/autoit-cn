<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>运行于64位 Windows 操作系统</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>
  <h1>运行于64位 Windows 操作系统</h1>
  <p>AutoIt 原先是一个32位应用程序. 当在 3.2.10.0 版本发布时添加了内部 x64 版本支持, 包括:</p>
  <ul>
    <li>AutoIt (AutoIt3_x64.exe)</li>
    <li>Aut2Exe (Aut2Exe_x64.exe)</li>
    <li>Au3Info (Au3Info_x64.exe)</li>
    <li>AutoItX (AutoItX3_x64.dll)</li>
  </ul>
  <p>During installation, if AutoIt is found to be running on an x64 system then you will be given the choice to install and configure the x64 versions. These versions are fully x64 compatible, however, some scripts that use <a href=
  "../functions/DllCall.htm">DllCall</a>/<a href="../functions/DllStructCreate.htm">DllStruct</a> with custom structures may use values that break 64-bit compatibility (such as using 32-bit integers for pointers). This includes some of the UDFs supplied
  with AutoIt as they have not all been tested under x64.</p>
  <p>You can run the x86 version of AutoIt by right-clicking a script and selecting "Run Script (x86)".</p>
  <p>If you suspect that a script is not working correctly under x64 but it works under x86 then please report a bug.</p>
  <p>To see if you are running under a 64-Bit edition of Windows use @OSArch macro. To see if you are using the 32 or 64-bit version of AutoIt use @AutoItX64.</p>
  <h2>Running the 32-bit version of AutoIt on a x64 System</h2>
  <p>For Files, Windows has a special redirection mechanism for some system directories :</p>
  <table summary="">
    <tr>
      <th>Directories</th>
      <th>32-bit Value</th>
      <th>64-Bit Value</th>
    </tr>
    <tr>
      <td>@SystemDir</td>
      <td>@WindowsDir &amp; "\SYSWOW64"</td>
      <td>@WindowsDir &amp; "\System32"</td>
    </tr>
    <tr>
      <td>@ProgramFilesDir</td>
      <td>{SystemDrive} &amp; "\Program Files (x86)"</td>
      <td>{SystemDrive} &amp; "\Program Files"</td>
    </tr>
  </table>
  <p>It is possible to access the 64-bit version of those directories by disabling the redirection mechanism.</p>
  <p class="codebox"><span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"kernel32.dll"</span><span class="S8">,</span> <span class="S7">"int"</span><span class="S8">,</span> <span class=
  "S7">"Wow64DisableWow64FsRedirection"</span><span class="S8">,</span> <span class="S7">"int"</span><span class="S8">,</span> <span class="S3">1</span><span class="S8">)</span><br></span></p>
  <p>更多信息请参考 <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog64/winprog64/file_system_redirector.asp">MSDN</a>.</p>
  <p>For registry, use HKCR64 or HKLM64 to bypass the redirection mechanism see Registry Functions documentation.</p>
</body>
</html>
