<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>AutoIt on Windows Vista</title>
  <meta http-equiv="Content-Type" content="text/html; charset=GB2312">
  <link href="../css/default.css" rel="stylesheet" type="text/css"></head>
<body>
<h1>AutoIt 于 Windows Vista </h1>
<p>Windows Vista 带来新的安全体验,但是限制了部分程序必须管理员才能运行. 没有管理员权限的用户每次运行一些需要管理员权限的操作时将会有一个提示.(例如写入到注册表 HKEY_LOCAL_MACHINE 或者写入到 C:\Windows 目录). 这是调用了 <strong>User Account Control (UAC)</strong>.</p>
<p>在默认情况下,Autoit 脚本运行于标准用户的权限下, 但是 AutoIt 已经提供了脚本作者一个 &quot;tag(标记)&quot; 来告诉 AutoIt 需要运行于管理员权限. </p>
<p>要强制一个脚本使用管理员权限运行,请添加 <strong>#requireadmin</strong> 到您的代码顶部,就像:</p>
<p class="codebox">
; 这个脚本需要完全控制权限<br>
  #requireadmin<br>
  <br>
  MsgBox(0, "信息", "这个脚本运行于管理员权限! ")</p>
<p class="code">&nbsp;</p>
<p>当脚本运行时, AutoIt 会检查自己是否已经拥有管理员权限,如果没有将会通知操作系统显示一个&quot;UAC 提示&quot;,说明用户权限不足 . 如果许可不给予脚本权限,脚本将终止. </p>
<p>&nbsp;</p>
<h2>UAC 提示</h2>
<p>Vista 将会在运行程序没有权限时出现下方窗口. (这类型提示/发生于用户为&quot;标准用户&quot; 或者 &quot;需要其它权限的管理员&quot; (记得每当 administrators 需要得到提高权限到 admin 操作时). 说明: 这个提示在有数字签名的程序运行时只会显示一个警告.Autoit 正式版本身是带有数字签名的.注:汉化程序会使数字签名失效.当 &quot;编译&quot; 时也可能出现下面的提示.) </p>
<p>&nbsp;</p>
<p><strong>标准用户提示</strong></p>
<p><img src="../images/autoit_standarduser_uac_signed.png" width="439" height="427"></p>
<p>一个标准的用户必须选择输入一个用户名和密码,才能以高权限继续运行脚本.</p>
<p>&nbsp;</p>
<p><strong>超级管理员(Administrator)用户提示</strong></p>
<p><img src="../images/autoit_uac_signed.png" width="439" height="241"></p>
<p>如果一个用户已经拥有管理员(administrator)权限,只需点击'继续' - 不需要再输入密码. </p>
<p>&nbsp;</p>
<h2>编译的脚本</h2>
<p>编译的脚本(可能是测试版本的 AutoIt) 是 <strong> 没有 </strong>数字签名的,系统会给予更严重的警告,如图:</p>
<p><img src="../images/compiled_uac_unsigned.png" width="460" height="369"> </p>
<p>用户必须单击 <strong>允许</strong> 来继续执行(或者输入一个密码,标准用户的话).</p>
<p> 如果你有一个可信任的数字签名,您可以给自己的程序进行数字签名.</p>
<p>&nbsp;</p>
<p><strong>重要: 不管 AutoIt 或者 一个已经编译的脚本(或者是其它程序)是否有数字签名, 您只能运行您信任的脚本或者程序!</strong></p>
<p><strong><u>因为它可能是恶意的!</u> </strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>