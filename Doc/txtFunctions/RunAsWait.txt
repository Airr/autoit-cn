###Function###
RunAsWait

###Description###
在不同的用户环境中运行一个外部程序和中止脚本执行直到程序完成.

###Syntax###
RunAsWait ( "用户名", "范围", "密码", 登录标志, "文件名" [, "工作目录" [, 显示标志 [, 选择标志 ]]] )


###Parameters###
@@ParamTable@@
用户名
	登录的用户名.
范围
	验证的依据范围.
密码
	用户的登录口令.
登录标志
	0 - 交互登录，没有 profile.
	1 - 交互登录，有 profile.
	2 - 网[络]唯一凭证.
	4 - 继承调用过程环境而非用户的.
文件名
	可执行文件的完整路径(文件格式为 EXE,BAT,COM 或 PIF)..
工作目录
	[可选] 工作目录. 如果不指定, 则使用 @SystemDir.
显示标志
	[可选] 启动程序时的初始状态:
	  @SW_HIDE = 隐藏窗口 (或 默认关键字)
	  @SW_MINIMIZE = 最小化窗口
	  @SW_MAXIMIZE = 最大化窗口
选择标志
	[可选] 控制不同选项处理父进程/子进程交互.
	  0x10000 ($RUN_CREATE_NEW_CONSOLE) = 子控制台进程应该与它一起建立自己的窗口而非使用父窗口. 当父层作为控制台应用被编译时，这标志才有用.
@@End@@


###ReturnValue###
@@ReturnTable@@
成功: 	返回运行程序的退出[代]码. 
失败: 	返回 0 并设置 @error 非零.
@@End@@


###Remarks###
指定你正在运行的用户工作目录是很重要的, 否则函数将会失败.

建议你只载入确定你需要的用户需求文件. There is a small chance a profile can be stuck in memory under the right conditions. 如果一个使用 RunAs() 的脚本作为系统帐户运行 (例如, 脚本当做一个服务运行) 和用户需求文件被载入, 你必须保持脚本运行直到子进程关闭.

当运行一个系统管理程序时, 第二次的登录 (RunAs) 服务必须被允许否则这函数将失败. 这个不应用到运行系统帐户时.

在运行那请求程序之后，脚本会暂停直到程序结束. 运行一个程序然后立刻继续脚本执行，需改为使用 RunAs 函数.

即使他们仍然在运行，一些程序也会立刻返回; 这些程序产生另外的一个进程 - 你能够使用 ProcessWaitClose 函数处理这些范例.

The "load profile" 与登录标志2 "网[络]唯一凭证" 选项不兼容. 使用两者将产生不明确的结果.

There is an issue in the Windows XP generation of Windows which prevents STDIO redirection and the show flag from working.  See Microsoft Knowledge Base article KB818858 for more information about which versions are affected as well as a hotfix for the issue.  使用 Windows 2000, Windows XP SP2 或更高版本, 以及 Windows Vista 没有这个影响.

###Related###
ProcessWait, ProcessWaitClose, Run, RunWait, ShellExecute, ShellExecuteWait, RunAs


###Example###
@@IncludeExample@@
