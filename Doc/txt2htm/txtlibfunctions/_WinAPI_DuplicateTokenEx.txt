###User Defined Function###
_WinAPI_DuplicateTokenEx

###Description###
Creates a new primary or impersonation access token that duplicates an existing token.

###Syntax###
#Include <WinAPIEx.au3>
_WinAPI_DuplicateTokenEx ( $hToken, $iAccess, $iLevel [, $iType [, $tSecurity]] )

###Parameters###
@@ParamTable@@
$hToken
	A handle to an access token opened with $TOKEN_DUPLICATE access.
$iAccess
	The requested access rights for the new token. To request the same access rights as the existing
	token, specify zero. To request all access rights that are valid for the caller, specify the
	$TOKEN_ALL_ACCESS access.
$iLevel
	The security impersonation levels.
	
	$SecurityAnonymous
	$SecurityIdentification
	$SecurityImpersonation
	$SecurityDelegation
	
$iType
	[可选参数] The token type.
	
	$TokenPrimary
	$TokenImpersonation
	
$tSecurity
	[可选参数] $tagSECURITY_ATTRIBUTES structure that specifies a security descriptor for the new token and
	determines whether child processes can inherit the token. If this parameter is 0, the token gets
	a default security descriptor and the handle cannot be inherited. If the security descriptor
	contains a system access control list, the token gets $ACCESS_SYSTEM_SECURITY access right,
	even if it was not requested.
@@End@@

###ReturnValue###
@@ReturnTable@@
Success	1.
Failure	0 and sets the @error flag to non-zero.
@@End@@

###Remarks###
When you have finished using the new token, call the _WinAPI_CloseHandle() function to close the token handle.


###See Also###
@@MsdnLink@@ DuplicateTokenEx

