###User Defined Function###
_WinAPI_CreateWindowStation

###Description###
创建关联到当前进程的窗口站对象并分配到当前会话

###Syntax###
#Include <WinAPIEx.au3>
_WinAPI_CreateWindowStation( [$sName [, $iAccess [, $iFlags [, $tSecurity]]]] )

###Parameters###
@@ParamTable@@
$sName
   要创建的窗口站的名称. 窗口站名称大小写敏感且不能包含斜杠(\). 仅Administrators组的成员允许指定名称. 如果该参数为空字符串, 系统使用所调用进程的登录会话标识符构成窗口站名称.
$iAccess
   [可选] 窗口站返回句柄的访问类型. 可为一个或多个下列值.
    $WINSTA_ALL_ACCESS - 所有可能的访问权限
    $WINSTA_ACCESSCLIPBOARD - 使用剪贴板所需
    $WINSTA_ACCESSGLOBALATOMS - 操作全局元素所需
    $WINSTA_CREATEDESKTOP - 在窗口站上创建新的桌面对象所需
    $WINSTA_ENUMDESKTOPS - 枚举存在的桌面对象所需
    $WINSTA_ENUMERATE - 枚举窗口站所需
    $WINSTA_EXITWINDOWS - 成功调用ExitWindows或ExitWindowsEx函数所需. 窗口站可由用户共享, 给标记可避免共享用户从窗口站注销窗口站所有者.
    $WINSTA_READATTRIBUTES - 读取窗口站对象的属性所需. 该属性包括颜色设置和其他全局窗口站属性.
    $WINSTA_READSCREEN - 访问屏幕内容所需
    $WINSTA_WRITEATTRIBUTES - 修改窗口站属性所需. 该属性包括颜色设置和其他全局窗口站属性.
$iFlags
   [可选] 可选标记. 可为0或下列值.
    $CWF_CREATE_ONLY - 如果指定该标记且窗口站已存在则函数失败
$tSecurity
$tagSECURITY_ATTRIBUTES结构. 为0表示不能继承.
@@End@@

###ReturnValue###
@@ReturnTable@@
成功: 返回新近建立的窗口站的句柄. 如果指定窗口站已存在, 函数成功并返回该窗口站句柄.
失败: 返回0并设置@error非0
@@End@@

###Remarks###
句柄使用完毕后必须调用_WinAPI_CloseWindowStation()释放句柄

###Related###

###See Also###