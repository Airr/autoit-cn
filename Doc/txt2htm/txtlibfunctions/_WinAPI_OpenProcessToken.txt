###用户自定义函数###
_WinAPI_OpenProcessToken

###描述###
打开与进程相关的访问令牌

###语法###
#Include <WinAPIEx.au3>
_WinAPI_OpenProcessToken( $iAccess [, $hProcess] )

###参数###
@@ParamTable@@
$iAccess
   指定获取访问令牌所需类型的访问掩码 . 该参数可为一个或多个下列值.
    $TOKEN_ADJUST_DEFAULT - 需要改变默认宿主, 基本组或访问令牌的自主访问控制列表(DACL)
    $TOKEN_ADJUST_GROUPS - 需要改变访问令牌中的组的属性
    $TOKEN_ADJUST_PRIVILEGES - 需要启用或禁用访问令牌中的权限
    $TOKEN_ADJUST_SESSIONID - 需要调整访问令牌中的进程ID
    $TOKEN_ASSIGN_PRIMARY - 需要将基本令牌连接到进程
    $TOKEN_DUPLICATE - 需要复制访问令牌
    $TOKEN_EXECUTE - $STANDARD_RIGHTS_EXECUTE和$TOKEN_IMPERSONATE结合
    $TOKEN_IMPERSONATE - 需要将模拟令牌连接到进程
    $TOKEN_QUERY - 需要查询访问令牌
    $TOKEN_QUERY_SOURCE - 需要查询访问令牌源
    $TOKEN_READ - $STANDARD_RIGHTS_READ和$TOKEN_QUERY结合
    $TOKEN_WRITE - $STANDARD_RIGHTS_WRITE, $TOKEN_ADJUST_PRIVILEGES, $TOKEN_ADJUST_GROUPS和$TOKEN_ADJUST_DEFAULT结合
    $TOKEN_ALL_ACCESS - 结合所有可能的访问权限
$hProcess
   已打开访问令牌的进程的句柄. 为0是使用当前进程.
@@End@@

###返回值###
@@ReturnTable@@
成功: 新打开的访问令牌的句柄
失败: 返回0并设置@error非0
@@End@@

###备注###
调用_WinAPI_FreeHandle()关闭此函数返回的访问令牌的句柄

###相关###

###参考###
 搜索MSDN知识库中OpenProcessToken的相关信息