###用户自定义函数###
_WinAPI_ReplaceFile

###描述###
以其他文件替换一个文件并创建原始文件的备份

###语法###
#Include <WinAPIEx.au3>
_WinAPI_ReplaceFile( $sReplacedFile, $sReplacementFile [, $sBackupFile [, $iFlags]] )

###参数###
@@ParamTable@@
$sReplacedFile
   将被替换的文件名.
$sReplacementFile
   $sReplacedFile文件的文件名
$sBackupFile
   $sReplacedFile文件备份的文件名. 如果该参数为空字符串, 不创建备份文件.
$iFlag
   替换选项. 该参数可为一个或多个下列值:
    $REPLACEFILE_WRITE_THROUGH - 在函数返回前保证文件替换信息复制到被刷新到磁盘
    $REPLACEFILE_IGNORE_MERGE_ERRORS - 忽略合并时出现的错误信息
    $REPLACEFILE_IGNORE_ACL_ERRORS - 忽略合并时替换文件ACL信息时发生的错误
@@End@@

###返回值###
@@ReturnTable@@
成功: 返回1
失败: 返回0并设置@error非0
@@End@@

###备注###
如果函数失败, 调用_WinAPI_GetLastError()函数获取扩展错误信息. 下述为可能的错误代码.
ERROR_UNABLE_TO_MOVE_REPLACEMENT - 1176 (0x498)
替换文件不能被重新命名. 如果lpBackupFileName被指定, 替换和被替换文件保留其原始文件名. 否则, 被替换的文件不再存在, 替换文件按原有名称存在.
ERROR_UNABLE_TO_MOVE_REPLACEMENT_2 - 1177(0x499)
无法移动替换的文件. 替换文件仍然以其原来的名字存在; 但是, 它从被替换的文件继承文件流及属性. 被替换的文件以lpBackupFileName指定的名称存在. 此错误仅在lpBackupFileName不是NULL时发生.
ERROR_UNABLE_TO_REMOVE_REPLACED - 1175(0x497)
无法删除被替换的文件. 被替换和替换文件保留其原始文件名.

###相关###

###参考###
 搜索MSDN知识库中ReplaceFile的相关信息