###User Defined Function###
_WinAPI_MoveFileEx

###Description###
带选项移动存在的文件或包含子目录的目录

###Syntax###
#Include <WinAPIEx.au3>
_WinAPI_MoveFileEx( $sSource, $sDestination [, $iFlags] )

###Parameters###
@@ParamTable@@
$sSource
   本地文件或目录名称
$sDestination
   位于本地机的文件或目录的新名称.
$MOVEFILE_COPY_ALLOWED.
    移动目录时, 目标必须处于同一驱动器.
$iFlags指定为$MOVEFILE_DELAY_UNTIL_REBOOT且$sDestination为空字符串, _WinAPI_MoveFileEx() 注册的$sSource文件将在系统重启时删除. 如果$sSource为目录, 仅当目录为空时系统将在重启时移动之.
$iFlags
   指定移动选项的标记. 可为下列值的一个或多个:
$MOVEFILE_COPY_ALLOWED
  - 如果文件将被移动至另一卷, 函数等于使用CopyFile和DeleteFile函数移动. 该值不能用于MOVEFILE_DELAY_UNTIL_REBOOT.
$MOVEFILE_CREATE_HARDLINK
  - 保留
$MOVEFILE_DELAY_UNTIL_REBOOT
  - 系统重启时才移动文件
$MOVEFILE_FAIL_IF_NOT_TRACKABLE
  - 如果文件为连接源且移动后无法跟踪时函数失败
$MOVEFILE_REPLACE_EXISTING
  - 目标文件存在时替换
$MOVEFILE_WRITE_THROUGH
  - 直到文件被实际移动函数才返回
@@End@@

###ReturnValue###
@@ReturnTable@@
成功: 返回-1
失败: 返回0并设置@error非0
@@End@@

###Remarks###
如果$iFlags参数指定为$MOVEFILE_DELAY_UNTIL_REBOOT, 当无法进入注册表时_WinAPI_MoveFileEx()失败.
函数存储文件的位置将在重启时使用注册表值: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations重命名

###Related###

###See Also###
 搜索MSDN知识库中MoveFileEx的相关信息

###Example###
@@IncludeExample@@