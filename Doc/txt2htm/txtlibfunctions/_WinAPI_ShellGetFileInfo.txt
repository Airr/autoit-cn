###用户自定义函数###
_WinAPI_ShellGetFileInfo

###描述###
获取文件系统中一个对象的信息

###语法###
#Include <WinAPIEx.au3>
_WinAPI_ShellGetFileInfo( $sPath, $iFlags, $iAttributes, ByRef $tSHFILEINFO )

###参数###
@@ParamTable@@
$sPath  包含绝对或相对路径和文件名的字符串. 可使用短文件名(8.3格式)或长文件名.
$iFlags参数包含$SHGFI_PIDL标记, 该参数必须是包含在Shell命名空间中用于唯一标识文件的项目标识符的列表的TEMIDLIST (PIDL)结构的地址. 项目标识符列表的指针必须是完全合法的PIDL. 不允许使用相对PIDL.
$iFlags参数包含$SHGFI_USEFILEATTRIBUTES标记, 该参数不必含有有效文件名. 函数将被执行, 如同指定名称且由$iAttributes参数指定属性的文件存在一样. 这允许通过传递$sPath中的扩展名及$iAttributes中的$FILE_ATTRIBUTE_NORMAL参数获取关于文件类型的信息.
$iFlags  该标记指定要获取的信息. 可为下列值的组合.
$SHGFI_ATTR_SPECIFIED - 获取文件指定属性
$SHGFI_ATTRIBUTES - 获取文件属性
$SHGFI_DISPLAYNAME - 获取文件显示名
$SHGFI_EXETYPE - 获取可执行文件类型
$SHGFI_ICON - 获取文件图标
$SHGFI_ICONLOCATION - 获取文件图标地址
$SHGFI_LARGEICON - 获取文件大图标
$SHGFI_LINKOVERLAY - 获取叠加的链接图标
$SHGFI_OPENICON - 获取打开图标
$SHGFI_OVERLAYINDEX - 获取叠加的索引
$SHGFI_PIDL - 标识符
$SHGFI_SELECTED - 选取状态的图标
$SHGFI_SHELLICONSIZE - 获取文件图标大小
$SHGFI_SMALLICON - 获取文件小图标
$SHGFI_SYSICONINDEX - 获取系统图标索引
$SHGFI_TYPENAME - 获取文件类型名
$SHGFI_USEFILEATTRIBUTES - 用于传递$iAttributes
$iAttributes  一个或多个文件属性标记的结合($FILE_ATTRIBUTE_...).
$iFlags不包含$SHGFI_USEFILEATTRIBUTES标记, 忽略该参数. 默认为0x80($FILE_ATTRIBUTE_NORMAL).
$tSHFILEINFO  接收文件信息的$tagSHFILEINFO结构.
@@End@@

###返回值###
@@ReturnTable@@
成功: $tagSHFILEINFO结构. 如果$iFlags包含$SHGFI_EXETYPE标记, @extended标记指定可执行文件类型.
    如果$iFlags包含$SHGFI_SYSICONINDEX标记, @extended标记指定系统图像列表的句柄.
失败: 返回0并设置@error非0.
@@End@@

###备注###
函数返回$tagSHFILEINFO结构的hIcon成员必须在不再需要时由_WinAPI_FreeIcon()函数释放.

###相关###

###参考###
 搜索MSDN知识库中SHGetFileInfo的相关信息