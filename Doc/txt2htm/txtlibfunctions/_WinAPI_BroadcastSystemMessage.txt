###用户自定义函数###
_WinAPI_BroadcastSystemMessage

###描述###
向指定接收方发送信息

###语法###
#Include <WinAPIEx.au3>
_WinAPI_BroadcastSystemMessage( $iMessage [, $wParam [, $lParam [, $iFlags [, $iRecipients]]]] )

###参数###
@@ParamTable@@
$iMessage
   要发送的消息
$wParam
   [可选] 额外的消息指定的信息
$lParam
   [可选] 额外的消息指定的信息
$iFlags
   [可选] 广播选项. 该参数可为一个或多个下列值:
    $BSF_ALLOWSFW - 允许接收方在执行消息是设置前景窗口
    $BSF_FLUSHDISK - 在每个接收方执行完消息后清空磁盘
    $BSF_FORCEIFHUNG - 继续广播消息, 即使已过超时时间或接收方之一无回应.
    $BSF_IGNORECURRENTTASK - 不向属于当前任务的窗体发送消息. 这将阻止应用程序接收自己的消息.
    $BSF_NOHANG - 强制无应答应用程序超时. 如果一个接收方超事则不再继续广播消息.
    $BSF_NOTIMEOUTIFNOTHUNG - 等待消息的回复直到接收方不再继续回应. 无超时.
    $BSF_POSTMESSAGE - 递送消息. 不与$BSF_QUERY结合使用.
    $BSF_QUERY - 一次向一个接收方发送消息, 直到当前接收方返回 TRUE 才发送给下一个接收方.
    $BSF_SENDNOTIFYMESSAGE - 使用SendNotifyMessage函数发送消息. 不与$BSF_QUERY结合使用.
$iRecipients
   [可选] 消息接收方. 该参数可为一个或多个下列值:
    $BSM_ALLCOMPONENTS - 广播到所有系统内容.
    $BSM_ALLDESKTOPS - 广播到所有桌面. 需要SE_TCB_NAME权限.
    $BSM_APPLICATIONS - 广播到应用程序
    $BSM_INSTALLABLEDRIVERS - Windows Me/98/95 广播到可安装驱动
    $BSM_NETDRIVER - Windows Me/98/95 广播到网络驱动
    $BSM_VXDS - Windows Me/98/95 广播到所有系统级设备驱动
@@End@@

###返回值###
@@ReturnTable@@
成功: 返回1或0(见下方) , @extended用以来标记接收标识接收方实际接收的消息BSM_...值的结合.
失败: 返回-1并设置@error非0.
@@End@@

###备注###
如果$iFlags参数是$BSF_QUERY且至少一个接收方对相应消息返回BROADCAST_QUERY_DENY , 返回值为0.
该系统仅为(在0到(WM_USER-1)范围内的)系统消息编组. 向另一进程发送其他消息( >= WM_USER) , 必须自定义编组.

###相关###

###参考###
 搜索MSDN知识库中BroadcastSystemMessage的相关信息