###User Defined Function###
_WinAPI_GetKeyboardState

###Description###
将256个虚拟键的状态复制到缓冲区

###Syntax###
#Include <WinAPIEx.au3>
_WinAPI_GetKeyboardState()

###Parameters###
@@ParamTable@@
    无
@@End@@

###ReturnValue###
@@ReturnTable@@
成功: 接收每个虚拟键状态数据的byte[256]结构
失败: 返回0并设置@error非0
@@End@@

###Remarks###
程序可调用该函数获取所有虚拟键的当前状态. 当进程从其消息队列中移除键盘消息时状态改变. 当键盘消息被发送到进程消息队列或被发送到其他进程或从其他进程接收键盘消息时, 状态不改变.
函数返回时, 数组的每个元素包含一个虚拟键的状态数据. 如果高阶数位为1, 表示键按下; 反之为抬起. 如果是切换键, 如CAPS LOCK, 则当激活时低阶数位为1, 未激活时为0. 低阶数位对非切换键无意义. 当切换键被认为激活的话表示其被打开. 键被激活时键盘上的切换键指示灯(如果有)将打开, 反之关闭.
使用_WinAPI_GetKeyState()函数获取状态信息. 使用_WinAPI_GetAsyncKeyState()获取一个单独键的当前信息不管是否从消息队列获取对应的键盘消息

###Related###

###See Also###
 搜索MSDN知识库中GetKeyboardState的相关信息